SELECT TBL_COLLEGE_ASSESSMENT_SUMMARY.STUDENT_NUMBER,
(SELECT TOP 1 LASTNAME + CASE EXTENSION_NAME WHEN 'N.A' THEN '' WHEN 'NONE' THEN '' WHEN '' THEN '' ELSE ' ' + EXTENSION_NAME END + ' ' + FIRSTNAME + CASE MIDDLENAME WHEN 'N.A' THEN '' WHEN 'NONE' THEN '' WHEN '' THEN '' ELSE ' ' + MIDDLENAME END FROM TBL_STUDENT_INFORMATION WHERE STUDENT_NUMBER = TBL_COLLEGE_ASSESSMENT_SUMMARY.STUDENT_NUMBER) AS STUDENT_NAME,
COURSE_CODE,YRLVL,SECT_CODE FROM TBL_COLLEGE_ASSESSMENT_SUMMARY WHERE PullOutStatus = 'ACTIVE' AND ACADEMIC_YR = '2017-2018' AND EDUCATION_LEVEL = 'SENIOR HIGH' AND NOT EXISTS (SELECT SUM(AMOUNT_COLLECTED) FROM TBL_COLLEGE_PAYMENT WHERE STUDENT_NUMBER = TBL_COLLEGE_ASSESSMENT_SUMMARY.STUDENT_NUMBER AND FEE_STATUS = 'TUITION FEE' AND RECIEPT_STATUS = 'ACTIVE' AND ACADEMIC_YR = '2017-2018' HAVING SUM(AMOUNT_COLLECTED) >= 250) ORDER BY STUDENT_NAME ASC


SELECT DISTINCT COURSE_CODE,YRLVL,
(SELECT COUNT(STUDENT_NUMBER) FROM TBL_COLLEGE_ASSESSMENT_SUMMARY WHERE PullOutStatus = 'ACTIVE' AND ACADEMIC_YR = SUMMARY.ACADEMIC_YR AND COURSE_CODE = SUMMARY.COURSE_CODE AND YRLVL = SUMMARY.YRLVL AND NOT EXISTS (SELECT SUM(AMOUNT_COLLECTED) FROM TBL_COLLEGE_PAYMENT WHERE STUDENT_NUMBER = TBL_COLLEGE_ASSESSMENT_SUMMARY.STUDENT_NUMBER AND RECIEPT_STATUS = 'ACTIVE' AND FEE_STATUS = 'TUITION FEE' AND ACADEMIC_YR = '2017-2018' HAVING SUM(AMOUNT_COLLECTED) >= 250)) AS NO_OF_STUDENTS ,
(SELECT COUNT(STUDENT_NUMBER) FROM TBL_COLLEGE_ASSESSMENT_SUMMARY WHERE PullOutStatus = 'ACTIVE' AND ACADEMIC_YR = SUMMARY.ACADEMIC_YR AND COURSE_CODE = SUMMARY.COURSE_CODE AND YRLVL = SUMMARY.YRLVL AND NOT EXISTS (SELECT SUM(AMOUNT_COLLECTED) FROM TBL_COLLEGE_PAYMENT WHERE STUDENT_NUMBER = TBL_COLLEGE_ASSESSMENT_SUMMARY.STUDENT_NUMBER AND RECIEPT_STATUS = 'ACTIVE' AND FEE_STATUS = 'TUITION FEE' AND ACADEMIC_YR = '2017-2018' HAVING SUM(AMOUNT_COLLECTED) >= 250) AND (SELECT GENDER FROM TBL_STUDENT_INFORMATION WHERE STUDENT_NUMBER = TBL_COLLEGE_ASSESSMENT_SUMMARY.STUDENT_NUMBER) = 'MALE') AS NO_OF_STUDENTS_MALE ,
(SELECT COUNT(STUDENT_NUMBER) FROM TBL_COLLEGE_ASSESSMENT_SUMMARY WHERE PullOutStatus = 'ACTIVE' AND ACADEMIC_YR = SUMMARY.ACADEMIC_YR AND COURSE_CODE = SUMMARY.COURSE_CODE AND YRLVL = SUMMARY.YRLVL AND NOT EXISTS (SELECT SUM(AMOUNT_COLLECTED) FROM TBL_COLLEGE_PAYMENT WHERE STUDENT_NUMBER = TBL_COLLEGE_ASSESSMENT_SUMMARY.STUDENT_NUMBER AND RECIEPT_STATUS = 'ACTIVE' AND FEE_STATUS = 'TUITION FEE' AND ACADEMIC_YR = '2017-2018' HAVING SUM(AMOUNT_COLLECTED) >= 250) AND (SELECT GENDER FROM TBL_STUDENT_INFORMATION WHERE STUDENT_NUMBER = TBL_COLLEGE_ASSESSMENT_SUMMARY.STUDENT_NUMBER) = 'FEMALE') AS NO_OF_STUDENTS_FEMALE
FROM TBL_COLLEGE_ASSESSMENT_SUMMARY AS SUMMARY WHERE PullOutStatus = 'ACTIVE' AND EDUCATION_LEVEL = 'SENIOR HIGH' AND ACADEMIC_YR = '2017-2018' AND VOUCHER_CODE NOT IN ('NONE','') ORDER BY YRLVL,COURSE_CODE ASC


SELECT * FROM TBL_COLLEGE_ASSESSMENT_BREAKDOWN WHERE FEE_AMOUNT < 260